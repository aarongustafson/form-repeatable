<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>&lt;form-repeatable&gt; Web Component Demo</title>
		<link rel="stylesheet" href="./styles.css" />
		<style>
			::part(button) {
				background: ButtonFace;
				color: ButtonText;
				border: 1px solid ButtonBorder;
				padding: 0.3rem 0.5rem;
				border-radius: 4px;
				font-size: 1rem;
				font-weight: bold;
				cursor: pointer;
				margin-block-start: 1rem;
				margin-inline-end: 0.5rem;
			}

			::part(button):is(:hover, :focus-visible) {
				opacity: 0.8;
			}

			.output {
				margin-top: 1rem;
				padding: 1rem;
				background-color: Field;
				border-radius: 4px;
				font-family: monospace;
				font-size: 0.875rem;
				max-height: 300px;
				overflow-y: auto;
			}

			.output h4 {
				margin-top: 0;
				font-family:
					-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
					sans-serif;
			}

			.output pre {
				margin: 0;
				white-space: pre-wrap;
			}

			form-repeatable.custom::part(add-button) {
				background-color: green;
				color: white;
			}
			form-repeatable.custom::part(add-button)::before {
				content: '+ '/ '';
			}

			form-repeatable.custom::part(remove-button) {
				background-color: red;
				color: white;
			}
			form-repeatable.custom::part(remove-button)::before {
				content: '− ' / '';
			}

			.info-box {
				margin-top: 2rem;
				padding: 1.5rem;
				background-color: #f0f7ff;
				border-left: 4px solid #0066cc;
				border-radius: 4px;
			}

			.info-box h4 {
				margin-top: 0;
				color: #0066cc;
			}

			.info-box ul {
				margin-bottom: 0;
			}
		</style>
	</head>
	<body>
		<header>
			<h1>&lt;form-repeatable&gt;</h1>
			<p>
				A web component that enables you to control the duplication of
				fields with native form participation using ElementInternals.
				Single-instance architecture manages all groups internally. See
				the
				<a
					href="https://github.com/aarongustafson/form-repeatable/blob/main/README.md"
					>README</a
				>
				for installation and API documentation.
			</p>
		</header>

		<main>
			<!-- Basic Example -->
			<section>
				<h2>Basic Example</h2>
				<p>
					A simple demonstration of repeatable fields. The first child
					element becomes the template automatically, with automatic
					ID and label incrementing.
				</p>

				<div class="demo-section">
					<h3>Travel Stops</h3>
					<p>
						Add multiple stops to your journey. The component
						manages all groups internally in its shadow DOM.
					</p>
					<div class="code-demo-pair">
						<pre><code>&lt;form&gt;
  &lt;form-repeatable&gt;
    &lt;div&gt;
      &lt;label for="stop-1"&gt;Stop 1&lt;/label&gt;
      &lt;input id="stop-1" type="text"
             name="stops[]"
             placeholder="Enter location"&gt;
    &lt;/div&gt;
  &lt;/form-repeatable&gt;
&lt;/form&gt;</code></pre>
						<div class="demo">
							<form id="basic-form">
								<fieldset>
									<legend>Trip Information</legend>
									<form-repeatable>
										<div>
											<label for="stop-1">Stop 1</label>
											<input
												id="stop-1"
												type="text"
												name="stops[]"
												placeholder="Enter location"
											/>
										</div>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Pre-populated Removable Fields -->
			<section>
				<h2>Pre-populated Fields (Progressive Enhancement)</h2>
				<p>
					Server-rendered initial groups are preserved. Each group
					becomes part of the shadow DOM.
				</p>

				<div class="demo-section">
					<h3>Contact Information</h3>
					<p>
						Multiple initial groups with values. The component
						recognizes them all and allows adding/removing.
					</p>
					<div class="code-demo-pair">
						<pre><code>&lt;form-repeatable&gt;
  &lt;div&gt;
    &lt;label for="phone-1"&gt;Phone 1&lt;/label&gt;
    &lt;input id="phone-1" type="tel"
           name="phones[]"
           value="555-0100"&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;label for="phone-2"&gt;Phone 2&lt;/label&gt;
    &lt;input id="phone-2" type="tel"
           name="phones[]"
           value="555-0101"&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;label for="phone-3"&gt;Phone 3&lt;/label&gt;
    &lt;input id="phone-3" type="tel"
           name="phones[]"
           value="555-0102"&gt;
  &lt;/div&gt;
&lt;/form-repeatable&gt;</code></pre>
						<div class="demo">
							<form id="prepopulated-form">
								<fieldset>
									<legend>Phone Numbers</legend>
									<form-repeatable>
										<div>
											<label for="phone-1">Phone 1</label>
											<input
												id="phone-1"
												type="tel"
												name="phones[]"
												value="555-0100"
											/>
										</div>
										<div>
											<label for="phone-2">Phone 2</label>
											<input
												id="phone-2"
												type="tel"
												name="phones[]"
												value="555-0101"
											/>
										</div>
										<div>
											<label for="phone-3">Phone 3</label>
											<input
												id="phone-3"
												type="tel"
												name="phones[]"
												value="555-0102"
											/>
										</div>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Min/Max Constraints -->
			<section>
				<h2>Min/Max Constraints</h2>
				<p>
					Control the number of allowed groups with
					<code>min</code> and <code>max</code> attributes.
				</p>

				<div class="demo-section">
					<h3>Team Members (2-5 allowed)</h3>
					<p>
						This example requires at least 2 members and allows up
						to 5. Remove buttons are hidden when at minimum, add
						button hidden at maximum.
					</p>
					<div class="code-demo-pair">
						<pre><code><mark>&lt;form-repeatable min="2" max="5"&gt;</mark>
  &lt;div&gt;
    &lt;label for="member-1"&gt;Member 1&lt;/label&gt;
    &lt;input id="member-1" type="text"
           name="members[]"&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;label for="member-2"&gt;Member 2&lt;/label&gt;
    &lt;input id="member-2" type="text"
           name="members[]"&gt;
  &lt;/div&gt;
<mark>&lt;/form-repeatable&gt;</mark></code></pre>
						<div class="demo">
							<form id="minmax-form">
								<fieldset>
									<legend>Project Team</legend>
									<form-repeatable min="2" max="5">
										<div>
											<label for="member-1"
												>Member 1</label
											>
											<input
												id="member-1"
												type="text"
												name="members[]"
												placeholder="Team member name"
											/>
										</div>
										<div>
											<label for="member-2"
												>Member 2</label
											>
											<input
												id="member-2"
												type="text"
												name="members[]"
												placeholder="Team member name"
											/>
										</div>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Explicit Template Element -->
			<section>
				<h2>Explicit Template Element</h2>
				<p>
					Use a <code>&lt;template&gt;</code> element for explicit
					template definition with <code>{n}</code> placeholders.
				</p>

				<div class="demo-section">
					<h3>Email Addresses</h3>
					<p>
						The template element is removed from the light DOM and
						used internally. Use <code>{n}</code> as the placeholder
						for numbers.
					</p>
					<div class="code-demo-pair">
						<pre><code>&lt;form-repeatable&gt;
  <mark>&lt;template&gt;</mark>
    &lt;div&gt;
      &lt;label for="email-<mark>{n}</mark>"&gt;Email <mark>{n}</mark>&lt;/label&gt;
      &lt;input id="email-<mark>{n}</mark>"
             type="email"
             name="emails[]"
             placeholder="user@example.com"&gt;
    &lt;/div&gt;
  <mark>&lt;/template&gt;</mark>
&lt;/form-repeatable&gt;</code></pre>
						<div class="demo">
							<form id="template-form">
								<fieldset>
									<legend>Contact Emails</legend>
									<form-repeatable>
										<template>
											<div>
												<label for="email-{n}"
													>Email {n}</label
												>
												<input
													id="email-{n}"
													type="email"
													name="emails[]"
													placeholder="user@example.com"
												/>
											</div>
										</template>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Multiple Fields -->
			<section>
				<h2>Multiple Fields per Group</h2>
				<p>
					Each repeatable group can contain multiple related fields.
					All elements inside the template/first child are duplicated
					together.
				</p>

				<div class="demo-section">
					<h3>Guest Information</h3>
					<p>Add guests with name and dietary requirements.</p>
					<div class="code-demo-pair">
						<pre><code>&lt;form-repeatable&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Guest 1&lt;/legend&gt;
    &lt;label for="guest-1"&gt;Name 1&lt;/label&gt;
    &lt;input id="guest-1" type="text"
           name="guests[]"&gt;

    &lt;label for="diet-1"&gt;Dietary Needs 1&lt;/label&gt;
    &lt;select id="diet-1" name="diets[]"&gt;
      &lt;option value=""&gt;None&lt;/option&gt;
      &lt;option value="vegetarian"&gt;Vegetarian&lt;/option&gt;
      &lt;option value="vegan"&gt;Vegan&lt;/option&gt;
      &lt;option value="gluten-free"&gt;Gluten Free&lt;/option&gt;
    &lt;/select&gt;
  &lt;/fieldset&gt;
&lt;/form-repeatable&gt;</code></pre>
						<div class="demo">
							<form id="multiple-form">
								<fieldset>
									<legend>Event Guests</legend>
									<form-repeatable>
										<fieldset>
											<legend>Guest 1</legend>
											<label for="guest-1">Name 1</label>
											<input
												id="guest-1"
												type="text"
												name="guests[]"
												placeholder="Guest name"
											/>
											<label for="diet-1"
												>Dietary Needs 1</label
											>
											<select id="diet-1" name="diets[]">
												<option value="">None</option>
												<option value="vegetarian">
													Vegetarian
												</option>
												<option value="vegan">
													Vegan
												</option>
												<option value="gluten-free">
													Gluten Free
												</option>
											</select>
										</fieldset>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Custom Labels -->
			<section>
				<h2>Custom Button Labels</h2>
				<p>
					Customize the "Add" and "Remove" button labels for better
					context.
				</p>

				<div class="demo-section">
					<h3>Shopping List</h3>
					<p>Using custom button labels.</p>
					<div class="code-demo-pair">
						<pre><code><mark>&lt;form-repeatable
  add-label="Add Item"
  remove-label="Delete Item"&gt;</mark>
  &lt;div&gt;
    &lt;label for="item-1"&gt;Item 1&lt;/label&gt;
    &lt;input id="item-1" type="text"
           name="items[]"&gt;
  &lt;/div&gt;
<mark>&lt;/form-repeatable&gt;</mark></code></pre>
						<div class="demo">
							<form id="custom-labels-form">
								<fieldset>
									<legend>Items</legend>
									<form-repeatable
										add-label="Add Item"
										remove-label="Delete Item"
									>
										<div>
											<label for="item-1">Item 1</label>
											<input
												id="item-1"
												type="text"
												name="items[]"
												placeholder="Enter item"
											/>
										</div>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Different Input Types -->
			<section>
				<h2>Different Container Elements</h2>
				<p>
					The template can be any element type - div, fieldset, p,
					etc. Works with various input types.
				</p>

				<div class="demo-section">
					<h3>Education History</h3>
					<p>Using a fieldset as the repeating container.</p>
					<div class="code-demo-pair">
						<pre><code>&lt;form-repeatable&gt;
  <mark>&lt;fieldset&gt;</mark>
    &lt;legend&gt;School 1&lt;/legend&gt;
    &lt;label for="school-1"&gt;Institution 1&lt;/label&gt;
    &lt;input id="school-1" type="text"
           name="schools[]"&gt;

    &lt;label for="degree-1"&gt;Degree 1&lt;/label&gt;
    &lt;select id="degree-1" name="degrees[]"&gt;
      &lt;option&gt;Select degree&lt;/option&gt;
      &lt;option value="hs"&gt;High School&lt;/option&gt;
      &lt;option value="bs"&gt;Bachelor's&lt;/option&gt;
    &lt;/select&gt;

    &lt;label for="notes-1"&gt;Notes 1&lt;/label&gt;
    &lt;textarea id="notes-1"
              name="notes[]"&gt;&lt;/textarea&gt;
  <mark>&lt;/fieldset&gt;</mark>
&lt;/form-repeatable&gt;</code></pre>
						<div class="demo">
							<form id="input-types-form">
								<fieldset>
									<legend>Schools Attended</legend>
									<form-repeatable>
										<fieldset>
											<legend>School 1</legend>
											<label for="school-1"
												>Institution 1</label
											>
											<input
												id="school-1"
												type="text"
												name="schools[]"
												placeholder="School name"
											/>
											<label for="degree-1"
												>Degree 1</label
											>
											<select
												id="degree-1"
												name="degrees[]"
											>
												<option value="">
													Select degree
												</option>
												<option value="hs">
													High School
												</option>
												<option value="bs">
													Bachelor's
												</option>
												<option value="ms">
													Master's
												</option>
												<option value="phd">
													Ph.D.
												</option>
											</select>
											<label for="notes-1">Notes 1</label>
											<textarea
												id="notes-1"
												name="notes[]"
												placeholder="Additional information"
											></textarea>
										</fieldset>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Events -->
			<section>
				<h2>Events</h2>
				<p>
					Listen to custom events fired when groups are added or
					removed.
				</p>

				<div class="demo-section">
					<h3>Event Logging</h3>
					<p>
						Watch the output below to see events firing with group
						count details.
					</p>
					<div class="code-demo-pair">
						<pre><code><mark>&lt;form-repeatable id="event-repeatable"&gt;</mark>
  &lt;div&gt;
    &lt;label for="ingredient-1"&gt;
      Ingredient 1
    &lt;/label&gt;
    &lt;input id="ingredient-1"
           type="text"
           name="ingredients[]"&gt;
  &lt;/div&gt;
<mark>&lt;/form-repeatable&gt;</mark>

&lt;script&gt;
  const repeatable =
    document.querySelector('#event-repeatable');

  <mark>repeatable.addEventListener(
    'form-repeatable:added', (e) =&gt; {</mark>
    console.log('Added:', e.detail.groupCount);
  <mark>});</mark>

  <mark>repeatable.addEventListener(
    'form-repeatable:removed', (e) =&gt; {</mark>
    console.log('Removed:', e.detail.groupCount);
  <mark>});</mark>
&lt;/script&gt;</code></pre>
						<div class="demo">
							<form id="events-form">
								<fieldset>
									<legend>Ingredients</legend>
									<form-repeatable id="event-repeatable">
										<div>
											<label for="ingredient-1"
												>Ingredient 1</label
											>
											<input
												id="ingredient-1"
												type="text"
												name="ingredients[]"
												placeholder="Add ingredient"
											/>
										</div>
									</form-repeatable>
								</fieldset>
							</form>
							<div class="output" id="events-output">
								<h4>Event Log:</h4>
								<pre id="event-log"></pre>
							</div>
						</div>
					</div>
				</div>
			</section>

			<!-- Custom Styling -->
			<section>
				<h2>Custom Styling with ::part()</h2>
				<p>
					Use CSS <code>::part()</code> to style the component's
					shadow DOM parts.
				</p>

				<div class="demo-section">
					<h3>Styled Buttons</h3>
					<p>
						This example uses <code>::part()</code> selectors to
						customize button appearance.
					</p>
					<div class="code-demo-pair">
						<pre><code>&lt;style&gt;
  form-repeatable<mark>::part(add-button)</mark> {
    background: green;
    color: white;
  }

  form-repeatable<mark>::part(remove-button)</mark> {
    background: red;
    color: white;
  }

  form-repeatable<mark>::part(group)</mark> {
    padding: 1rem;
    background: #f5f5f5;
    margin-bottom: 0.5rem;
  }
&lt;/style&gt;

&lt;form-repeatable&gt;
  &lt;div&gt;
    &lt;label for="task-1"&gt;Task 1&lt;/label&gt;
    &lt;input id="task-1" type="text"
           name="tasks[]"&gt;
  &lt;/div&gt;
&lt;/form-repeatable&gt;</code></pre>
						<div class="demo">
							<style>
								#styled-form form-repeatable::part(add-button) {
									background: green;
									color: white;
									border: none;
									padding: 0.5rem 1rem;
									border-radius: 4px;
									cursor: pointer;
								}

								#styled-form
									form-repeatable::part(add-button):hover {
									background: darkgreen;
								}

								#styled-form
									form-repeatable::part(remove-button) {
									background: red;
									color: white;
									border: none;
									padding: 0.5rem 1rem;
									border-radius: 4px;
									cursor: pointer;
								}

								#styled-form
									form-repeatable::part(remove-button):hover {
									background: darkred;
								}

								#styled-form form-repeatable::part(group) {
									padding: 1rem;
									background: #f5f5f5;
									border-radius: 4px;
									margin-bottom: 0.5rem;
								}
							</style>
							<form id="styled-form">
								<fieldset>
									<legend>Styled Example</legend>
									<form-repeatable>
										<div>
											<label for="task-1">Task 1</label>
											<input
												id="task-1"
												type="text"
												name="tasks[]"
												placeholder="Enter task"
											/>
										</div>
									</form-repeatable>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</section>

			<!-- Form Participation Example -->
			<section>
				<h2>Form Participation with Mixed Fields</h2>
				<p>
					The component uses <strong>ElementInternals API</strong> for
					native form participation. All inputs within the shadow DOM
					are automatically collected and submitted with the form.
					This example combines repeatable fields with regular form
					fields to demonstrate seamless integration.
				</p>

				<div class="demo-section">
					<h3>Event Registration Form</h3>
					<p>
						Fill in your details and add attendees. Click Submit to
						see how the FormData combines regular fields with
						repeatable groups.
					</p>
					<div class="code-demo-pair">
						<pre><code>&lt;form id="combined-form"&gt;
  &lt;!-- Regular form fields --&gt;
  &lt;label for="event-name"&gt;Event Name&lt;/label&gt;
  &lt;input id="event-name" name="eventName"
         type="text" required&gt;

  &lt;label for="event-date"&gt;Date&lt;/label&gt;
  &lt;input id="event-date" name="eventDate"
         type="date" required&gt;

  &lt;!-- Repeatable fields via component --&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Attendees&lt;/legend&gt;
    &lt;form-repeatable min="1" max="10"&gt;
      &lt;div&gt;
        &lt;label for="attendee-1"&gt;Attendee 1&lt;/label&gt;
        &lt;input id="attendee-1" type="text"
               name="attendees[]"
               placeholder="Full name" required&gt;
        &lt;label for="email-1"&gt;Email 1&lt;/label&gt;
        &lt;input id="email-1" type="email"
               name="emails[]"
               placeholder="email@example.com"&gt;
      &lt;/div&gt;
    &lt;/form-repeatable&gt;
  &lt;/fieldset&gt;

  &lt;button type="submit"&gt;Register&lt;/button&gt;
&lt;/form&gt;</code></pre>
						<div class="demo">
							<form id="combined-form">
								<label for="event-name">Event Name</label>
								<input
									id="event-name"
									name="eventName"
									type="text"
									placeholder="Annual Conference"
									required
								/>

								<label for="event-date">Date</label>
								<input
									id="event-date"
									name="eventDate"
									type="date"
									required
								/>

								<label for="event-location">Location</label>
								<input
									id="event-location"
									name="eventLocation"
									type="text"
									placeholder="City, State"
								/>

								<fieldset>
									<legend>Attendees (Min: 1, Max: 10)</legend>
									<form-repeatable min="1" max="10">
										<div>
											<label for="attendee-1"
												>Attendee 1</label
											>
											<input
												id="attendee-1"
												type="text"
												name="attendees[]"
												placeholder="Full name"
												required
											/>
											<label for="att-email-1"
												>Email 1</label
											>
											<input
												id="att-email-1"
												type="email"
												name="emails[]"
												placeholder="email@example.com"
											/>
										</div>
									</form-repeatable>
								</fieldset>

								<button type="submit">Register Event</button>
							</form>
							<div class="output" id="combined-output"></div>
						</div>
					</div>
				</div>

				<div class="info-box">
					<h4>How It Works</h4>
					<p>
						When you submit the form, notice how the FormData
						includes:
					</p>
					<ul>
						<li>
							<strong>Regular fields</strong> (eventName,
							eventDate, eventLocation) from the light DOM
						</li>
						<li>
							<strong>Repeatable fields</strong> (attendees[],
							emails[]) collected from the shadow DOM via
							ElementInternals
						</li>
						<li>
							All values are properly combined into a single
							FormData object
						</li>
					</ul>
					<p>
						The component automatically syncs its shadow DOM inputs
						with the parent form, so no special handling is needed.
						It works just like native form controls!
					</p>
				</div>
			</section>

			<!-- API Reference -->
			<section class="api-reference">
				<h2>API Reference</h2>

				<h3>Attributes</h3>
				<ul>
					<li>
						<code>min</code> - Number (default: 1). Minimum number
						of groups required. Must be a positive integer. Remove
						buttons are hidden when at minimum.
					</li>
					<li>
						<code>max</code> - Number (optional). Maximum number of
						groups allowed. Must be greater than min. Add button is
						hidden when at maximum.
					</li>
					<li>
						<code>add-label</code> - String (default: "Add
						Another"). Custom label for the add button.
					</li>
					<li>
						<code>remove-label</code> - String (default: "Remove").
						Custom label for the remove buttons.
					</li>
				</ul>

				<h3>Template Definition</h3>
				<ul>
					<li>
						<strong>First Child:</strong> By default, the first
						child element becomes the template. Numbers in IDs,
						labels, and text are automatically converted to
						<code>{n}</code> placeholders.
					</li>
					<li>
						<strong>Explicit Template:</strong> Use a
						<code>&lt;template&gt;</code> element with
						<code>{n}</code> placeholders for explicit control. The
						template element is removed from light DOM.
					</li>
				</ul>

				<h3>Events</h3>
				<ul>
					<li>
						<code>form-repeatable:added</code> - Fired when a new
						group is added. Detail contains
						<code>{groupCount}</code>.
					</li>
					<li>
						<code>form-repeatable:removed</code> - Fired when a
						group is removed. Detail contains
						<code>{groupCount}</code>.
					</li>
				</ul>

				<h3>CSS Parts</h3>
				<ul>
					<li>
						<code>::part(groups)</code> - Container for all groups
						(default: CSS grid with 2-column layout).
					</li>
					<li>
						<code>::part(group)</code> - Each repeatable group
						wrapper (default: subgrid spanning both columns).
					</li>
					<li>
						<code>::part(content)</code> - Container for the group's
						fields (default: column 1).
					</li>
					<li>
						<code>::part(group-controls)</code> - Container for
						group-level controls, remove button (default: column 2).
					</li>
					<li>
						<code>::part(controls)</code> - Container for main
						controls, add button (default: below groups).
					</li>
					<li><code>::part(add-button)</code> - The add button.</li>
					<li>
						<code>::part(remove-button)</code> - The remove buttons.
					</li>
				</ul>

				<h3>Default Styling</h3>
				<p>
					The component uses a <strong>CSS Grid layout</strong> by
					default:
				</p>
				<ul>
					<li>
						Two-column grid:
						<code>minmax(min-content, 2fr)</code> and
						<code>minmax(min-content, 1fr)</code>
					</li>
					<li>
						Each group uses <code>subgrid</code> to align content
						with controls
					</li>
					<li>
						Content appears in column 1, remove buttons in column 2
					</li>
					<li>Add button appears below all groups</li>
					<li>
						<strong
							>Global stylesheets are automatically
							adopted</strong
						>
						into the shadow DOM, so your page styles will apply to
						elements inside the component
					</li>
				</ul>

				<h3>Form Participation</h3>
				<p>
					This component uses the
					<strong>ElementInternals API</strong> for native form
					participation. All inputs within the shadow DOM are
					automatically collected and submitted with the form using
					<code>FormData</code>. Supports form reset and disabled
					states. Browser support: 95% (Chrome 77+, Firefox 93+,
					Safari 16.4+).
				</p>

				<p>
					For complete documentation, see the
					<a
						href="https://github.com/aarongustafson/form-repeatable/blob/main/README.md"
						>README</a
					>.
				</p>
			</section>
		</main>

		<footer>
			<p>
				Made with ❤️ by
				<a href="https://github.com/aarongustafson">Aaron Gustafson</a>.
				View the source on
				<a href="https://github.com/aarongustafson/form-repeatable"
					>GitHub</a
				>.
			</p>
		</footer>

		<script src="../define.js" type="module"></script>
		<script type="module">
			// Helper to display FormData contents
			function displayFormData(form, output) {
				const formData = new FormData(form);
				const data = {};

				for (let [key, value] of formData.entries()) {
					if (key.endsWith('[]')) {
						const arrayKey = key.slice(0, -2);
						if (!data[arrayKey]) {
							data[arrayKey] = [];
						}
						data[arrayKey].push(value);
					} else {
						if (!data[key]) {
							data[key] = value;
						} else if (Array.isArray(data[key])) {
							data[key].push(value);
						} else {
							data[key] = [data[key], value];
						}
					}
				}

				output.innerHTML = `<h4>FormData Contents:</h4><pre>${JSON.stringify(data, null, 2)}</pre>`;
			}

			// Form participation example
			const combinedForm = document.getElementById('combined-form');
			const combinedOutput = document.getElementById('combined-output');
			const combinedRepeatable =
				combinedForm.querySelector('form-repeatable');

			// Show FormData on submit
			combinedForm.addEventListener('submit', (e) => {
				e.preventDefault();
				displayFormData(combinedForm, combinedOutput);
			});

			// Auto-update FormData display when groups change
			combinedRepeatable.addEventListener('form-repeatable:added', () => {
				displayFormData(combinedForm, combinedOutput);
			});
			combinedRepeatable.addEventListener(
				'form-repeatable:removed',
				() => {
					displayFormData(combinedForm, combinedOutput);
				},
			);

			// Show initial state
			displayFormData(combinedForm, combinedOutput);

			// Event logging
			const eventLog = document.getElementById('event-log');
			const eventRepeatable = document.getElementById('event-repeatable');

			function logEvent(eventName, detail) {
				const timestamp = new Date().toLocaleTimeString();
				const logEntry = `[${timestamp}] ${eventName} - Group count: ${detail.groupCount}\n`;
				eventLog.textContent = logEntry + eventLog.textContent;
			}

			eventRepeatable.addEventListener('form-repeatable:added', (e) => {
				logEvent('form-repeatable:added', e.detail);
				console.log('Group added:', e.detail);
			});

			eventRepeatable.addEventListener('form-repeatable:removed', (e) => {
				logEvent('form-repeatable:removed', e.detail);
				console.log('Group removed:', e.detail);
			});
		</script>
	</body>
</html>
